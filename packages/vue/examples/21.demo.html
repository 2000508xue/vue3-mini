<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      #app {
        padding: 200px;
      }
    </style>
  </head>
  <body>
    <div id="app"></div>
    <script type="module">
      // import {
      //   createApp,
      //   h,
      //   ref,
      //   KeepAlive,
      //   onMounted,
      //   onUnmounted,
      // } from '../../../node_modules/vue/dist/vue.esm-browser.prod.js'

      import {
        createApp,
        h,
        ref,
        KeepAlive,
        onMounted,
        onUnmounted,
      } from '../dist/vue.esm.js'

      const Comp1 = {
        name: 'Comp1',
        setup() {
          onMounted(() => {
            console.log('Comp1 挂载了')
          })
          onUnmounted(() => {
            console.log('Comp1 卸载了')
          })
          return () => {
            return h('div', ['Comp1：', h('input')])
          }
        },
      }

      const Comp2 = {
        name: 'Comp2',
        setup() {
          onMounted(() => {
            console.log('Comp2 挂载了')
          })
          onUnmounted(() => {
            console.log('Comp2 卸载了')
          })
          return () => {
            return h('div', ['Comp2：', h('input')])
          }
        },
      }

      const Comp3 = {
        name: 'Comp3',
        setup() {
          onMounted(() => {
            console.log('Comp3 挂载了')
          })
          onUnmounted(() => {
            console.log('Comp3 卸载了')
          })
          return () => {
            return h('div', ['Comp3', h('input')])
          }
        },
      }

      const App = {
        name: 'App',
        setup() {
          const componentes = [Comp1, Comp2, Comp3]
          const index = ref(0)
          const onClick = () => {
            if (index.value < 2) {
              index.value++
            } else {
              index.value = 0
            }
          }
          return () => {
            return h('div', [
              h('p', '我是父组件的P标签'),
              h('button', { onClick }, '切换组件'),
              h(KeepAlive, { max: 2 }, () => h(componentes[index.value])),
            ])
          }
        },
      }

      createApp(App).mount('#app')
    </script>
  </body>
</html>
